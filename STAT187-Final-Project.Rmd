---
title: 'Stat/CS 187: Final Project'
author: "Huaye Yang, Halina Vercessi, and Matthew Mccarthy"
date: "Spring 2022"
output:
  word_document:
    toc: yes
  html_document:
    toc: yes
    df_print: paged
---
  

```{r setup, message = FALSE}
knitr::opts_chunk$set(echo = TRUE,
                      fig.width=10, 
                      fig.height=10 )

# Load the packages
pacman::p_load(gapminder, tidyverse, skimr, socviz, grid, stringr,
               usmap, maps, statebins, viridis, leaflet)


```  

***

# 1. Introduction


**What is the source of the data? Where and when was it created?** 
The data comes from a survey created in 2014 by Mona Chalabi as research for an article for Five Thirty Eight (from ABC News). 
The survey was filled out by 1,057 American adults. 
Here is the article that resulted from the survey: https://fivethirtyeight.com/features/dear-mona-how-many-couples-sleep-in-separate-beds/


Assigned to: Halina Vercessi 


**If it is a sample, from what population was it drawn, and how was the sample selected?**
**Do you suspect any sampling bias?**
**Was it an experiment or an observational study?**

Assigned to: Matthew Mccarthy


**How were measurements taken, or questions asked? Do you suspect any bias in the questions or measurements?**

Assigned to: Huaye Yang 


**Why is this data of interest to you, and why should the class find it interesting?**
**What kind of data cleaning was necessary (rename columns, n/a in the survey = not applicable, option = add blank space placeholder/indicator**
**Data cleaning implementation**
Before this survey, the most detailed data and reports on this subject were gathered and made in 2004 by the National Sleep Foundation. The data from the National Sleep Foundation provided the numbers on how many couples slept separately but did not gather data that could offer insight as to the reasons couples sleep apart and why couples sleep in separate beds. This data is interesting because it is the kind of data that could be useful to psychologists and social workers. This data can be used to examine stereotypes we have about why couples sleep separately and which age ranges of couples sleep separately along with being useful for examining why couples sleep separately.

Something that is interesting to note when working with this data is that the responses are purely categorical, not numeric. The cleaning that we did in the data was to rename the columns because the original column names were built from the survey questions (separated by periods) and they were very long and tedious to work with. We also removed the first row as it served as almost a second title row but was being counted in the rows of data. We considered labeling the blank / no answer spaces as N/A but N/A means something in this data as it is a valid response to specific check boxes. 

Assigned to: Halina Vercessi



```{r clean_data}

# Read in data
sleeping_alone_data1 <- read.csv("R_sleeping_alone.csv", stringsAsFactors = T)

# Take a look at the relationship status column, 7 categories
summary(sleeping_alone_data1)

# Rename columns to simpler names based on survey questions
sleeping_alone_data <- sleeping_alone_data1 %>%
  
  rename( Relationship_Status = Which.of.the.following.best.describes.your.current.relationship.status., 
         Relationship_Length = How.long.have.you.been.in.your.current.relationship..If.you.are.not.currently.in.a.relationship..please.answer.according.to.your.last.relationship.,
         How_Often_Sep_Beds = When.both.you.and.your.partner.are.at.home..how.often.do.you.sleep.in.separate.beds., 
         Diff_Bed_Where_You_Sleep = When.you.re.not.sleeping.in.the.same.bed.as.your.partner..where.do.you.typically.sleep., 
         Diff_Bed_Where_Partner_Sleep = When.you.re.not.sleeping.in.the.same.bed..where.does.your.partner.typically.sleep., 
         Sep_Beds_Reasons = What.are.the.reasons.that.you.sleep.in.separate.beds..Please.select.all.that.apply., 
         When_First_Time_Sep_Beds = When.was.the.first.time.you.slept.in.separate.beds., 
         Statement_Help_Stay_Together =  To.what.extent.do.you.agree.with.the.following.statement...sleeping.in.separate.beds.helps.us.to.stay.together.., 
         Statement_Better_Sleep =  To.what.extent.do.you.agree.with.the.following.statement...we.sleep.better.when.we.sleep.in.separate.beds..,
         Statement_Improved_Sex_Life = To.what.extent.do.you.agree.with.the.following.statement.ë_.our.sex.life.has.improved.as.a.result.of.sleeping.in.separate.beds..ë_, 
         Current_Occupation =  Which.of.the.following.best.describes.your.current.occupation.,
         Household_Income = Household.Income,  
         Location_Census_Region = Location..Census.Region.)
  

sleeping_alone_data <- sleeping_alone_data %>% slice(-c(1))

head(sleeping_alone_data)

```

***

# 2. Data Visualizations

**Create 4 graphs. Write a paragraph summarizing what you see, and suggesting some implications**


## 2.1 Length of Relationship and Age (Graph 1):  


**Relate the length of relationships, bed status (separate beds vs same bed), and age.**

**Is it more likely that couples who have been together longer will sleep in separate beds more often?**


### 2.1.1 Graph 1 --> Halina 
```{r 2a_graph1}

sleeping_alone_data2 <- sleeping_alone_data %>%
  
  group_by(Relationship_Length, How_Often_Sep_Beds) %>%
  
  summarise(count_freq = n()) %>%
  
  mutate(Proportion = round(count_freq/sum(count_freq), digits = 5)) %>%
  
  select(Relationship_Length, How_Often_Sep_Beds, Proportion) %>% 
  
  slice(-c(1)) %>%
  
  ungroup()


rel_length_bar <- ggplot(data = sleeping_alone_data2,
                            mapping = aes(x = Relationship_Length,
                                          y = Proportion, 
                                          fill = How_Often_Sep_Beds)) +
  
                     geom_col(position = "dodge") + 
  
                     labs(x = "Relationship Length",
                          fill = "How Often Couples Sleep Separately", 
                          title = "Frequency Sleeping Separately and Relationship Length (proportions)")+
  
                    scale_y_continuous(labels = scales::percent) +
                    scale_x_discrete(name = "Relationship Length (years)", labels = c("No Answer", "1-5", "11-15", "16-20", "6-10","< 1", "> 20" )) +
                    facet_wrap(~How_Often_Sep_Beds) +
                    theme(legend.position = "NA")
rel_length_bar

# OLD FIGURE IDEA

# length_and_start_graph <-
#   ggplot(data = sleeping_alone_data, 
#         mapping = aes(x = Relationship_Length, 
#                       y = How_Often_Sep_Beds)) +
#   
#   geom_jitter(mapping = aes(color = When_First_Time_Sep_Beds)) +
#   
#   facet_wrap(facets = ~When_First_Time_Sep_Beds) +
#   
#   scale_x_discrete(name = "Relationship Length (years)", labels = c("No Answer", "1-5", "11-15", "16-20", "6-10","< 1", "> 20" )) +
#   
#   scale_y_discrete(name = "How Often Couple Sleeps in Separate Beds", labels = c("No Answer", "Few Times Per Month", "Few Times Per Week", "Every Night", "Never", "Once a Month or Less","Once a Year or Less")) +
#   
#   theme(legend.position = "NA") +
#   
#   labs(title = "Relationship Length, Frequency Sleeping in Separate Beds, and When it Started")
# 
# length_and_start_graph
```

```{r 2a_graph1.1}


sleeping_alone_data3 <- sleeping_alone_data %>%
  
  group_by(Age, How_Often_Sep_Beds) %>%
  
  summarise(count_freq = n()) %>%
  
  mutate(Proportion = round(count_freq/sum(count_freq), digits = 5)) %>%
  
  select(Age, How_Often_Sep_Beds, Proportion) %>% 
  
  slice(-c(1)) %>%
  
  ungroup()


prop_age_bar <- ggplot(data = sleeping_alone_data3,
                            mapping = aes(x = Age,
                                          y = Proportion, 
                                          fill = How_Often_Sep_Beds)) +
  
                     geom_col(position = "dodge") + 
  
                     labs(x = "Age",
                          fill = "How Often Couples Sleep Separately", 
                          title = "Frequency Sleeping Separately and Age (proportions)")+
  
                    scale_y_continuous(labels = scales::percent)+ 
                    scale_x_discrete(name = "Age Range", labels = c("No Answer", "60-Up", "18-29", "30-44", "45-60")) +
                    facet_wrap(~How_Often_Sep_Beds) +
                    theme(legend.position = "NA")
prop_age_bar

# OLD FIGURE IDEA
# start_and_age_graph <-
#   ggplot(data = sleeping_alone_data, 
#         mapping = aes(x = Age, 
#                       y = How_Often_Sep_Beds)) +
#   
#   geom_jitter(mapping = aes(color = When_First_Time_Sep_Beds)) +
#   
#   facet_wrap(facets = ~When_First_Time_Sep_Beds) +
#   
#   scale_x_discrete(name = "Age Range", labels = c("No Answer", "60-Up", "18-29", "30-44", "45-60")) +
#   
#   scale_y_discrete(name = "How Often Couple Sleeps in Separate Beds", labels = c("No Answer", "Few Times Per Month", "Few Times Per Week", "Every Night", "Never", "Once a Month or Less","Once a Year or Less")) +
#   
#   theme(legend.position = "NA") +
#   
#   labs(title = "Relationship Length, Frequency Sleeping in Separate Beds, and When it Started")
# 
# start_and_age_graph


```



### 2.1.2 Summarizing Paragraph:
From this graph, it appears that the majority of couples who do sleep in separate beds every night started sleeping separately earlier
on in the relationship (within 1-5 years of the relationship) as can be seen in the last graph, but also note that the relationship lengths 
that follow this pattern are mainly under 20 years in length and greater than 1 year. 
Another interesting pattern that can be noted from these visuals is that for those who have been in a very long-term relationship (greater than 20 years), the majority of those couples sleeping in separate beds every night or a few times per week started this sleeping situation
within 16 to 20 year or more than 20 years into their relationship. 


***


## 2.2 Occupation and Income (Graph 2 and Graph 3) --> Huaye

**Relate occupation, income, and bed status with how often they sleep separately.**

**Do occupational demands affect sleeping status? Is someone with a more demanding job more likely to sleep separately?**
**(Could call for inclusion or examination of another data-set that has information on occupational categories and average hours worked per day or week.)**


### 2.2.1 Graph 2
```{r 2b_graph2}
# GRAPH 2

# Relate occupation to bed status (and how often they sleep)

```

### 2.2.2 Summarizing Paragraph:


***


### 2.2.3 Graph 3
```{r 2b_graph3}
# GRAPH 3

# Second graph could build on first (add income as a factor)

```

### 2.2.4 Summarizing Paragraph:


***



## 2.3 Reasons for Sleeping Separately (Graph 4) --> Matthew

**Relate how often couples sleep in different beds with the reason they sleep separately.**

**How correlated are the reasons they sleep in separate beds with the frequency they sleep together?**
**Reasons include snoring, frequent bathroom trips, sickness, intimacy issues, etc.**

### 2.3.1 Graph 4
```{r 2c_graph4}
# GRAPH 4

# Categorical (bar or scatter plot)

```

### 2.3.2 Summarizing Paragraph:


***


**NOTE: put conclusion section together at end after summary paragraphs are written (draw from those)**
# 3 Conclusions:  
**Write some overall conclusions – an overall summary of what you learned from your visualizations and analysis. Summarize in one paragraph**

# 4 Limitations / Recommendations: 
**Write a paragraph describing some of the limitations that are inherent in your study. Also discuss ideas for future research that might build on the work you did in this project. Summarize in one paragraph.**





